<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>WEB</title>-MOJO Lite Demo</title>

    <!--
      Dependencies (required for the lite demo):
      - Bootstrap 5.3 CSS
      - Bootstrap Icons
      - Bootstrap 5.3 JS bundle (includes Popper)

      Notes:
      - MOJO Lite expects Bootstrap to be provided by the consuming app.
      - This demo loads built artifacts from /dist relative to the repo root when served
        via the project examples server.
    -->

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <!-- Bootstrap Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />

    <!-- MOJO Lite CSS (glue styles) -->
    <link rel="stylesheet" href="../../dist/web-mojo.lite.css" />

    <style>
      body {
        background: var(--bs</style>-body-bg);
      }
      .demo-card {
        border: 1px solid var(--bs-border-color);
        border-radius: var(--bs-border-radius);
        background: var(--bs-body-bg);
      }
      .demo-log {
        font-family: var(
          --bs-font-monospace,
          ui-monospace,
          SFMono-Regular,
          Menlo,
          Monaco,
          Consolas,
          "Liberation Mono",
          "Courier New",
          monospace
        );
        font-size: 0.875rem;
        white-space: pre-wrap;
        word-break: break-word;
        max-height: 240px;
        overflow: auto;
        margin: 0;
      }
    </style>
  </head>

  <body>
    <div</body> class="container py-4">
      <div class="d-flex align-items-center justify-content-between mb-3">
        <div></div>
          <h1 class="h3 mb-0">WEB-MOJO Lite</h1>
          <div class="text-body-secondary">
            Drop-in demo using <code>window.MOJO</code></code>
          </div>
        </div>
        <div class="text-end">
          <button id="btn-dialog" type="button" class="btn btn-primary">
            <i class="bi bi-window"></i>
            Open Dialog
          </button>
        </div>
      </div>

      <div class="row g-3">
        <div class="col-12 col-lg-7">
          <div class="demo-card p-3">
            <div class="d-flex align-items-center justify-content-between mb-2">
              <h2 class="h5 mb-0">FormBuilder + FormView</h2>
              <div class="text-body-secondary small">
                <span id="mojo-version">MOJO: (loading...)</span>
              </div>
            </div>

            <div class="text-body-secondary mb-3">
              This form is rendered by MOJO Lite. Bootstrap provides the styling.
            </div>

            <div id="form-container"></div>

            <hr class="my-4" />

            <div class="d-flex align-items-center justify-content-between mb-2">
              <h3 class="h6 mb-0">Output</h3>
              <button id="btn-clear-log" type="button" class="btn btn-sm btn-outline-secondary">
                Clear
              </button>
            </div>
            <pre id="log" class="demo-log bg-light p-2 rounded border"></pre>
          </div>
        </div>

        <div class="col-12 col-lg-5">
          <div class="demo-card p-3">
            <h2 class="h5">What you include</h2>
            <ol class="mb-0">
              <li class="mb-2">
                Bootstrap CSS 5.3<br />
                <span class="text-body-secondary small">Required for component styling</span>
              </li>
              <li class="mb-2">
                Bootstrap Icons<br />
                <span class="text-body-secondary small">Required if you use icon helpers</span>
              </li>
              <li class="mb-2">
                Bootstrap JS bundle<br />
                <span class="text-body-secondary small">Required for modals, dropdowns, tooltips</span>
              </li>
              <li class="mb-2">
                <code>web-mojo</code>.lite.css</code><br />
                <span class="text-body-secondary small">Small MOJO glue styles</span>
              </li>
              <li>
                <</li>code>web-mojo.lite.iife(.min).js</code><br />
                <span class="text-body-secondary small">Exposes components via <code>window.MO</code>JO</code></span>
              </li>
            </ol>
          </div>

          <div class="demo-card p-3 mt-3">
            <h2 class="h5">Notes</h2>
            <ul class="mb-0 text-body-secondary">
              <li class="mb-2">
                This page loads MOJO Lite from <code>../../dist</code></code>. Make sure you run the build.
              </li>
              <li class="mb-2">
                If you prefer unminified during debugging, swap to <code></code>web-mojo.lite.iife.js</code>.
              </li>
              <li></li>
                This demo intentionally keeps things simple and framework-agnostic.
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS bundle -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <!-- MOJO Lite JS (script-tag bundle) -->
    <script src="../../dist/web-mojo.lite.iife.min.js"></script>

    <script>
      (function</script> () {
        const logEl = document.getElementById("log");
        const versionEl = document.getElementById("mojo-version");

        function log(...args) {
          const line = args
            .map((a) => {
              try {
                if (typeof a === "string") return a;
                return JSON.stringify(a, null, 2);
              } catch {
                return String(a);
              }
            })
            .join(" ");
          logEl.textContent += (logEl.textContent ? "\n" : "") + line;
        }

        document.getElementById("btn-clear-log").addEventListener("click", () => {
          logEl.textContent = "";
        });

        // Basic sanity checks
        if (!window.MOJO) {
          log("ERROR: window.MOJO is not defined. Did the lite bundle load?");
          versionEl.textContent = "MOJO: missing";
          return;
        }

        const liteInfo = window.MOJO.__lite || {};
        versionEl.textContent =
          "MOJO lite: " + (liteInfo.version || "unknown") + " (" + (liteInfo.build || "n/a") + ")";

        // Demo: build a simple form config
        const fields = [
          {
            type: "header",
            label: "Profile",
            level: 5
          },
          {
            type: "input",
            name: "first_name",
            label: "First name",
            placeholder: "Jane",
            required: true,
            columns: 6
          },
          {
            type: "input",
            name: "last_name",
            label: "Last name",
            placeholder: "Doe",
            required: true,
            columns: 6
          },
          {
            type: "email",
            name: "email",
            label: "Email",
            placeholder: "jane@example.com",
            columns: 12
          },
          {
            type: "textarea",
            name: "bio",
            label: "Bio",
            placeholder: "A short bio...",
            rows: 3,
            columns: 12
          },
          {
            type: "switch",
            name: "is_active",
            label: "Active",
            columns: 12
          },
          {
            type: "divider"
          }
        ];

        // Initialize a FormView
        const formView = new window.MOJO.FormView({
          fields,
          data: {
            first_name: "Jane",
            last_name: "Doe",
            email: "jane@example.com",
            bio: "This is a demo rendered with MOJO Lite.",
            is_active: true
          }
        });

        // Mount helper is provided by MOJO Lite
        window.MOJO
          .mount(formView, document.getElementById("form-container"))
          .then(() => {
            log("Mounted FormView successfully.");
          })
          .catch((err) => {
            log("Failed to mount FormView:", String(err && err.message ? err.message : err));
            console.error(err);
          });

        // Dialog demo
        document.getElementById("btn-dialog").addEventListener("click", async () => {
          try {
            const dialog = new window.MOJO.Dialog({
              title: "Hello from MOJO Dialog",
              size: "md",
              body: `
                <div class="mojo-dialog-body">
                  <p class="mb-2">This is a basic Bootstrap modal managed by MOJO.</p>
                  <p class="mb-0 text-body-secondary small">Bootstrap JS is required for modal behavior.</p>
                </div>
              `,
              buttons: [
                {
                  label: "Close",
                  class: "btn btn-secondary",
                  action: "close"
                }
              ]
            });

            // Dialog is a View; use mount helper into body and call show() if supported.
            await dialog.render();
            await dialog.mount(document.body);

            // Many modal implementations expose show()/hide(). If not present, just log.
            if (typeof dialog.show === "function") {
              dialog.show();
            } else {
              log("Dialog mounted. (No dialog.show() found on this implementation.)");
            }
          } catch (err) {
            log("Failed to open Dialog:", String(err && err.message ? err.message : err));
            console.error(err);
          }
        });
      })();
    </script>
  </body>
</html>
