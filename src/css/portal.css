/**
 * MOJO Framework Portal Styles
 * Portal layout, sidebar, topnav, and group selector components
 * Version: 2.0.0
 *
 * Note: This file contains only custom MOJO styles.
 * Bootstrap 5 is required as a dependency for base styles.
 */

/* ========================================================================
   SIDEBAR USAGE GUIDE
   ========================================================================

   The MOJO Portal Layout uses a single flexbox-based sidebar system.

   HTML Structure:

   <div class="portal-container">
     <div class="portal-layout">
       <div id="portal-sidebar">
         <nav class="sidebar sidebar-light"> <!-- or sidebar-dark, sidebar-clean -->
           <div class="sidebar-container">
             <div class="sidebar-header">...</div>
             <div class="sidebar-body">
               <ul class="sidebar-nav">
                 <li class="nav-item">
                   <a class="nav-link" data-tooltip="Home">
                     <i class="bi-house me-2"></i>
                     <span class="nav-text">Home</span>
                   </a>
                 </li>
               </ul>
             </div>
             <div class="sidebar-footer">...</div>
           </div>
         </nav>
       </div>
       <div class="portal-body">
         <div id="portal-topnav">...</div>
         <div class="portal-content">...</div>
       </div>
     </div>
   </div>

   Sidebar States:
   - Default: Full width sidebar (250px)
   - .collapse-sidebar: Collapsed to icon-only (64px) - nav-text hidden
   - .hide-sidebar: Completely hidden (0px)
   - .sidebar-open: Mobile overlay state

   Themes:
   - .sidebar-light: Light theme
   - .sidebar-dark: Dark theme
   - .sidebar-clean: Clean minimal theme

   Mobile Behavior:
   - < 768px: Sidebar becomes fixed overlay
   - Backdrop appears when open
   - Always full width when visible

   ======================================================================== */

/* ========================================================================
   Portal Layout System (Custom MOJO Component)
   ======================================================================== */

:root {
    --mojo-sidebar-width: 250px;
    --mojo-sidebar-collapsed-width: 40px;
    --mojo-portal-gap: 0;
    --mojo-portal-bg: var(--bs-body-bg);
    --mojo-topnav-bg: var(--bs-primary, #121620);
    --mojo-topnav-color: var(#fff);
    --mojo-portal-muted: var(--bs-secondary-color);
    --mojo-portal-border: var(--bs-border-color);
    --mojo-portal-text: var(--bs-body-color);
    --mojo-sidebar-dark-color: #fff;
    --mojo-sidebar-dark-color-hover: #5388d6;
    --mojo-sidebar-dark-bg: #343a40;
}

.portal-layout {
    display: flex;
    min-height: 100vh;
    height: 100vh;
    background: var(--mojo-portal-bg);
}

#portal-sidebar {
    flex: 0 0 var(--mojo-sidebar-width);
    max-width: var(--mojo-sidebar-width);
    inline-size: var(--mojo-sidebar-width);
    height: 100%;
    overflow-y: hidden;
    z-index: 1;
    transition:
        inline-size 300ms cubic-bezier(0.4, 0, 0.2, 1),
        max-width 300ms cubic-bezier(0.4, 0, 0.2, 1),
        flex-basis 300ms cubic-bezier(0.4, 0, 0.2, 1),
        margin-left 300ms cubic-bezier(0.4, 0, 0.2, 1),
        transform 300ms cubic-bezier(0.4, 0, 0.2, 1);
    will-change: inline-size, max-width, flex-basis, transform;
}

.portal-container.collapse-sidebar #portal-sidebar {
    inline-size: var(--mojo-sidebar-collapsed-width);
    max-width: var(--mojo-sidebar-collapsed-width);
    flex-basis: var(--mojo-sidebar-collapsed-width);
}

.portal-container.hide-sidebar #portal-sidebar {
    margin-left: calc(-1 * var(--mojo-sidebar-width));
    border-inline-end: 0;
}

.portal-body {
    flex: 1 1 auto;
    min-width: 0;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

#portal-topnav {
    flex: 0 0 auto;
    background: var(--mojo-topnav-bg);
    color: var(--mojo-topnav-color);
    border-block-end: 1px solid var(--mojo-portal-border);
}

.portal-content {
    flex: 1 1 auto;
    min-height: 0;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 16px;
    height: 100%;
}

.portal-content .muted {
    color: var(--mojo-portal-muted);
}

@media (prefers-reduced-motion: reduce) {
    #portal-sidebar {
        transition: none;
    }
}

/* ========================================================================
   MOJO Custom Sidebar Component
   ======================================================================== */

/* Standalone sidebar (when not in portal layout) */
.sidebar {
    display: flex;
    flex-direction: column;
    height: 100%;
    width: 100%;
    min-height: 0;
    transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);
}

/* Portal-integrated sidebar (inside #portal-sidebar) */
#portal-sidebar .sidebar {
    position: static;
    top: auto;
    left: auto;
    height: 100%;
    width: 100%;
    z-index: auto;
    transform: none;
}

/* Custom Sidebar Themes */
.sidebar-dark {
    background-color: var(--mojo-sidebar-dark-bg, --bs-dark);
    color: var(--bs-light);
    border-inline-end: 1px solid var(--bs-border-color-translucent);
}

.sidebar-light {
    background-color: var(--bs-light);
    color: var(--bs-body-color);
    border-right: 1px solid var(--bs-border-color);
}

.sidebar-clean {
    background-color: var(--bs-body-bg);
    color: var(--bs-body-color);
    border-right: 1px solid var(--bs-border-color);
    box-shadow: var(--bs-box-shadow);
}

.sidebar-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    min-height: 0;
    flex: 1;
}

.sidebar-body {
    flex: 1;
    overflow-y: auto;
    min-height: 0;
}

.sidebar-brand {
    height: 56px;
    text-align: center;
    padding-top: 14px;
}

.sidebar-dark .sidebar-brand {
    border-bottom: 1px solid var(--bs-border-color-translucent);
}

.sidebar-light .sidebar-brand {
    border-bottom: 1px solid var(--bs-border-color);
}

.sidebar-clean .sidebar-brand {
    border-bottom: 1px solid var(--bs-border-color);
    background-color: var(--bs-secondary-bg);
}

.sidebar-brand.clickable {
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.sidebar-brand.clickable:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

/* ========================================================================
   Sidebar Toggle Button
   ======================================================================== */

.sidebar-toggle {
    position: absolute;
    width: 30px;
    height: 30px;
    font-size: 0.875rem;
    border: none;
    background: none;
    top: 0.75rem;
    right: 5px;
    border: none;
    border-radius: var(--bs-border-radius);
    color: var(--bs-body-color);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition:
        all 300ms cubic-bezier(0.4, 0, 0.2, 1),
        transform 150ms ease-out;
    backdrop-filter: blur(4px);
    z-index: 10;
}

.sidebar-toggle:hover {
    background: var(--bs-secondary-bg);
    transform: scale(1.1);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.sidebar-toggle:active {
    transform: scale(0.95);
    transition-duration: 100ms;
}

/* Toggle button icons */
.sidebar-toggle .toggle-icon {
    transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);
}

.sidebar-toggle .bi-chevron-left {
    display: block;
}

.sidebar-toggle .bi-chevron-right {
    display: none;
}

/* Collapsed state - swap icons */
.portal-container.collapse-sidebar .sidebar-toggle .bi-chevron-left {
    display: none;
}

.portal-container.collapse-sidebar .sidebar-toggle .bi-chevron-right {
    display: block;
}

/* Hidden state - show expand icon */
.portal-container.hide-sidebar .sidebar-toggle {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
}

/* Theme-specific toggle button styles */
.sidebar-dark .sidebar-toggle {
    background: var(--bs-border-color-translucent);
    color: var(--bs-secondary-color);
    border-color: var(--bs-border-color-translucent);
}

.sidebar-dark .sidebar-toggle:hover {
    background: var(--bs-secondary-bg);
    color: var(--bs-light);
}

.sidebar-light .sidebar-toggle {
    background: var(--bs-secondary-bg);
    color: var(--bs-body-color);
    border-color: var(--bs-border-color);
}

.sidebar-light .sidebar-toggle:hover {
    background: var(--bs-tertiary-bg);
    color: var(--bs-emphasis-color);
}

.sidebar-clean .sidebar-toggle {
    background: var(--bs-light);
    color: var(--bs-primary);
    border-color: var(--bs-primary-border-subtle);
    box-shadow: var(--bs-box-shadow-sm);
}

.sidebar-clean .sidebar-toggle:hover {
    background: var(--bs-primary);
    color: white;
    box-shadow: 0 4px 12px rgba(var(--bs-primary-rgb), 0.3);
}

/* Toggle button animation when sidebar state changes */
.sidebar-toggle .toggle-icon {
    transform: rotate(0deg);
}

/*.portal-container.collapse-sidebar .sidebar-toggle .toggle-icon {
    transform: rotate(180deg);
}*/

.portal-container #portal-sidebar {
    overflow: visible !important;
}

.portal-container .sidebar-body {
    overflow: visible !important;
}

/* ========================================================================
   TopNav Sidebar Toggle Button
   ======================================================================== */

.topnav-sidebar-toggle {
    background: none !important;
    border: none !important;
    color: rgba(255, 255, 255, 0.9);
    padding: 0.5rem;
    border-radius: 0.375rem;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.topnav-sidebar-toggle:hover {
    background: none !important;
    color: var(--bs-light);
    transform: scale(1.1);
}

.topnav-sidebar-toggle:focus {
    outline: none;
    box-shadow: none;
}

.topnav-sidebar-toggle .toggle-chevron {
    font-size: 1.1rem;
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    transform: rotate(180deg); /* Default: points left (expanded state) */
}

/* Collapsed/Hidden state - chevron points right */
.portal-container.collapse-sidebar .topnav-sidebar-toggle .toggle-chevron,
.portal-container.hide-sidebar .topnav-sidebar-toggle .toggle-chevron {
    transform: rotate(0deg);
}

/* Theme-specific styles */
.navbar-dark .topnav-sidebar-toggle {
    color: #ccc;
}

.navbar-dark .topnav-sidebar-toggle:hover {
    color: #fff;
    background: none !important;
}

.navbar-light .topnav-sidebar-toggle {
    color: var(--bs-navbar-light-color);
}

.navbar-light .topnav-sidebar-toggle:hover {
    color: var(--bs-navbar-light-hover-color);
    background: var(--bs-secondary-bg) !important;
}

/* Pulse animation for better discoverability */
@keyframes sidebar-toggle-pulse {
    0% {
        box-shadow: 0 0 0 0 rgba(var(--bs-primary-rgb), 0.4);
    }
    70% {
        box-shadow: 0 0 0 8px rgba(var(--bs-primary-rgb), 0);
    }
    100% {
        box-shadow: 0 0 0 0 rgba(var(--bs-primary-rgb), 0);
    }
}

/* Show pulse animation on first load or when sidebar is collapsed for a while */
.sidebar-toggle.pulse {
    animation: sidebar-toggle-pulse 2s infinite;
}

/* Toggle button focus states */
.sidebar-toggle:focus {
    outline: none;
    box-shadow: 0 0 0 0.25rem rgba(var(--bs-primary-rgb), 0.25);
}

.sidebar-toggle:focus-visible {
    outline: 2px solid var(--bs-primary);
    outline-offset: 2px;
}

/* Collapsed sidebar toggle positioning */
/*.portal-container.collapse-sidebar .sidebar-toggle {
    right: 0.5rem;
    width: 2rem;
    height: 2rem;
    font-size: 0.875rem;
}*/

/* Dark theme toggle button */
[data-bs-theme="dark"] .sidebar-toggle {
    background: rgba(255, 255, 255, 0.1);
    color: var(--bs-light);
    border-color: rgba(255, 255, 255, 0.15);
}

[data-bs-theme="dark"] .sidebar-toggle:hover {
    background: rgba(255, 255, 255, 0.2);
    color: var(--bs-white);
    box-shadow: 0 4px 12px rgba(255, 255, 255, 0.1);
}

[data-bs-theme="dark"] .sidebar-clean .sidebar-toggle {
    background: var(--bs-primary);
    color: white;
    border-color: var(--bs-primary);
}

[data-bs-theme="dark"] .sidebar-clean .sidebar-toggle:hover {
    background: var(--bs-primary);
    filter: brightness(1.1);
}

.brand-content {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.brand-logo {
    max-height: 32px;
    width: auto;
    margin-bottom: 0.5rem;
}

.brand-subtext {
    font-size: 0.75rem;
}

/* Custom Navigation Styles */
.sidebar-nav {
    display: flex;
    flex-direction: column;
    height: 100%;
    padding: 0.5rem 0;
    min-height: 0;
}

.sidebar-nav .nav-link {
    display: flex;
    align-items: center;
    position: relative;
    padding: 0.75rem 1rem;
    text-decoration: none;
    border-radius: 0;
    transition:
        all 300ms cubic-bezier(0.4, 0, 0.2, 1),
        transform 150ms ease-out;
    cursor: pointer;
    transform: translateX(0);
}

.sidebar-nav .nav-link:hover {
    transform: translateX(2px);
}

.sidebar-nav .nav-link i {
    width: 20px;
    text-align: center;
    transition:
        transform 200ms ease-out,
        color 200ms ease-out;
}

.sidebar-nav .nav-link:hover i {
    transform: scale(1.1);
}

.portal-container.collapse-sidebar .sidebar-nav .nav-link:hover i {
    transform: scale(1.2);
}

.sidebar-nav .collapse .nav-link {
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
}

.sidebar-nav .bi-chevron-down {
    transition: transform 0.3s;
}

.sidebar-nav .nav-link[aria-expanded="true"] .bi-chevron-down {
    transform: rotate(180deg);
}

/* Theme-specific navigation styles */
.sidebar-dark .sidebar-nav .nav-link {
    color: var(--mojo-sidebar-dark-color, #fff);
}

.sidebar-dark .sidebar-nav .nav-link:hover {
    color: var(--mojo-sidebar-dark-color-hover, #5388d6);
    background-color: var(--bs-secondary-bg);
}

.sidebar-dark .sidebar-nav .nav-link.active {
    color: var(--bs-light);
    background-color: var(--bs-primary);
}

.sidebar-light .sidebar-nav .nav-link {
    color: var(--bs-body-color);
}

.sidebar-light .sidebar-nav .nav-link:hover {
    color: var(--bs-emphasis-color);
    background-color: var(--bs-secondary-bg);
}

.sidebar-light .sidebar-nav .nav-link.active {
    color: var(--bs-light);
    background-color: var(--bs-primary);
}

.sidebar-clean .sidebar-nav .nav-link {
    color: var(--bs-secondary-color);
    margin: 0.125rem 0.5rem;
    border-radius: var(--bs-border-radius);
}

.sidebar-clean .sidebar-nav .nav-link:hover {
    color: var(--bs-body-color);
    background-color: var(--bs-secondary-bg);
}

.sidebar-clean .sidebar-nav .nav-link.active {
    color: var(--bs-primary);
    background-color: var(--bs-primary-bg-subtle);
    font-weight: 500;
}

.nav-text {
    flex: 1;
    white-space: nowrap;
    transition:
        opacity 300ms cubic-bezier(0.4, 0, 0.2, 1),
        width 300ms cubic-bezier(0.4, 0, 0.2, 1),
        margin 300ms cubic-bezier(0.4, 0, 0.2, 1);
}

.nav-arrow {
    transition:
        transform 200ms ease,
        opacity 300ms cubic-bezier(0.4, 0, 0.2, 1),
        margin 300ms cubic-bezier(0.4, 0, 0.2, 1);
    margin-left: auto;
}

.nav-link[aria-expanded="true"] .nav-arrow {
    transform: rotate(180deg);
}

/* Collapsed sidebar behavior */
.portal-container.collapse-sidebar .nav-text,
.portal-container.collapse-sidebar .sidebar-collapse-hide {
    opacity: 0;
    width: 0;
    margin-right: 0;
    overflow: hidden;
}

.portal-container.collapse-sidebar .nav-arrow {
    opacity: 0;
    margin-left: 0;
}

.portal-container.collapse-sidebar .sidebar-nav .nav-link {
    justify-content: center;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
    transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);
}

.portal-container.collapse-sidebar .sidebar-nav .nav-link i {
    margin-right: 0 !important;
}

.portal-container.collapse-sidebar .nav-submenu {
    display: none !important;
}

.portal-container.collapse-sidebar .sidebar-header {
    text-align: center;
    overflow: hidden;
}

.portal-container.collapse-sidebar .sidebar-header .fs-5 {
    opacity: 0;
    transition:
        opacity 300ms cubic-bezier(0.4, 0, 0.2, 1),
        transform 300ms cubic-bezier(0.4, 0, 0.2, 1);
    transform: scale(0.8) translateY(-5px);
}

.portal-container.collapse-sidebar .sidebar-footer {
    opacity: 0;
    transition:
        opacity 300ms cubic-bezier(0.4, 0, 0.2, 1),
        transform 300ms cubic-bezier(0.4, 0, 0.2, 1);
    transform: scale(0.8) translateY(5px);
}

/* ========================================================================
   Enhanced Tooltip System for Collapsed Sidebar
   ======================================================================== */

.portal-container.collapse-sidebar .sidebar .nav-link {
    position: relative;
    overflow: visible;
    width: var(--mojo-sidebar-collapsed-width, 48px);
}

/* Primary tooltip using data-tooltip attribute */
.portal-container.collapse-sidebar .sidebar .nav-link[data-tooltip]:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    left: calc(100% + 12px);
    top: 50%;
    transform: translateY(-50%) translateX(-5px);
    background: var(--bs-dark);
    color: var(--bs-white);
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
    white-space: nowrap;
    font-size: 0.875rem;
    font-weight: 500;
    line-height: 1.2;
    z-index: var(--mojo-zindex-tooltip);
    box-shadow:
        0 4px 12px rgba(0, 0, 0, 0.15),
        0 2px 4px rgba(0, 0, 0, 0.1);
    opacity: 0;
    visibility: hidden;
    transition:
        opacity 200ms cubic-bezier(0.4, 0, 0.2, 1),
        visibility 200ms cubic-bezier(0.4, 0, 0.2, 1),
        transform 200ms cubic-bezier(0.4, 0, 0.2, 1);
    animation: tooltip-slide-in 250ms cubic-bezier(0.4, 0, 0.2, 1) forwards;
    animation-delay: 1600ms;
    pointer-events: none;
}

/* Tooltip arrow */
.portal-container.collapse-sidebar .sidebar .nav-link[data-tooltip]:hover::before {
    content: "";
    position: absolute;
    left: calc(100% + 6px);
    top: 50%;
    transform: translateY(-50%);
    width: 0;
    height: 0;
    border-style: solid;
    border-width: 6px 6px 6px 0;
    border-color: transparent var(--bs-dark) transparent transparent;
    z-index: calc(var(--mojo-zindex-tooltip) + 1);
    opacity: 0;
    animation: tooltip-arrow-slide-in 250ms cubic-bezier(0.4, 0, 0.2, 1) forwards;
    animation-delay: 300ms;
}

/* Auto-tooltip using nav-text content (fallback when no data-tooltip) */
.portal-container.collapse-sidebar .sidebar .nav-link:not([data-tooltip]):hover::after {
    content: attr(data-nav-text);
    position: absolute;
    left: calc(100% + 12px);
    top: 50%;
    transform: translateY(-50%) translateX(-5px);
    background: var(--bs-dark);
    color: var(--bs-white);
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
    white-space: nowrap;
    font-size: 0.875rem;
    font-weight: 500;
    line-height: 1.2;
    z-index: var(--mojo-zindex-tooltip);
    box-shadow:
        0 4px 12px rgba(0, 0, 0, 0.15),
        0 2px 4px rgba(0, 0, 0, 0.1);
    opacity: 0;
    visibility: hidden;
    animation: tooltip-slide-in 250ms cubic-bezier(0.4, 0, 0.2, 1) forwards;
    animation-delay: 300ms;
    pointer-events: none;
}

.portal-container.collapse-sidebar .sidebar .nav-link:not([data-tooltip]):hover::before {
    content: "";
    position: absolute;
    left: calc(100% + 6px);
    top: 50%;
    transform: translateY(-50%);
    width: 0;
    height: 0;
    border-style: solid;
    border-width: 6px 6px 6px 0;
    border-color: transparent var(--bs-dark) transparent transparent;
    z-index: calc(var(--mojo-zindex-tooltip) + 1);
    opacity: 0;
    animation: tooltip-arrow-slide-in 250ms cubic-bezier(0.4, 0, 0.2, 1) forwards;
    animation-delay: 300ms;
}

/* Theme-specific tooltips */
.portal-container.collapse-sidebar .sidebar-light .nav-link:hover::after {
    background: #2c3e50;
    color: white;
}

.portal-container.collapse-sidebar .sidebar-light .nav-link:hover::before {
    border-right-color: #2c3e50;
}

.portal-container.collapse-sidebar .sidebar-dark .nav-link:hover::after {
    background: #34495e;
    color: #ecf0f1;
}

.portal-container.collapse-sidebar .sidebar-dark .nav-link:hover::before {
    border-right-color: #34495e;
}

.portal-container.collapse-sidebar .sidebar-clean .nav-link:hover::after {
    background: var(--bs-primary);
    color: white;
    box-shadow:
        0 4px 12px rgba(var(--bs-primary-rgb), 0.3),
        0 2px 4px rgba(var(--bs-primary-rgb), 0.2);
}

.portal-container.collapse-sidebar .sidebar-clean .nav-link:hover::before {
    border-right-color: var(--bs-primary);
}

/* Tooltip animations */
@keyframes tooltip-slide-in {
    0% {
        opacity: 0;
        visibility: hidden;
        transform: translateY(-50%) translateX(-10px) scale(0.9);
    }
    100% {
        opacity: 1;
        visibility: visible;
        transform: translateY(-50%) translateX(0) scale(1);
    }
}

@keyframes tooltip-arrow-slide-in {
    0% {
        opacity: 0;
        transform: translateY(-50%) translateX(-3px);
    }
    100% {
        opacity: 1;
        transform: translateY(-50%) translateX(0);
    }
}

/* Dark theme tooltips */
[data-bs-theme="dark"] .portal-container.collapse-sidebar .sidebar .nav-link:hover::after {
    background: var(--bs-light);
    color: var(--bs-dark);
}

[data-bs-theme="dark"] .portal-container.collapse-sidebar .sidebar .nav-link:hover::before {
    border-right-color: var(--bs-light);
}

/* Mobile layout: hide tooltips */
.portal-container.mobile-layout .nav-link:hover::after,
.portal-container.mobile-layout .nav-link:hover::before {
    display: none !important;
}

/* ========================================================================
   TOOLTIP USAGE GUIDE
   ========================================================================

   Option 1: Manual Tooltips (Recommended)
   Add data-tooltip attributes to your nav links:

   <a class="nav-link" data-tooltip="Dashboard">
       <i class="bi-speedometer2 me-2"></i>
       <span class="nav-text">Dashboard</span>
   </a>

   Option 2: Auto-Tooltips with JavaScript
   Use this script to automatically generate tooltips from nav-text:

   // Auto-generate tooltips from nav-text content
   document.querySelectorAll('.sidebar-nav .nav-link').forEach(link => {
       const navText = link.querySelector('.nav-text');
       if (navText && !link.hasAttribute('data-tooltip')) {
           link.setAttribute('data-nav-text', navText.textContent.trim());
       }
   });

   // Or set data-tooltip directly for better control
   document.querySelectorAll('.sidebar-nav .nav-link').forEach(link => {
       const navText = link.querySelector('.nav-text');
       if (navText && !link.hasAttribute('data-tooltip')) {
           link.setAttribute('data-tooltip', navText.textContent.trim());
       }
   });

   SIDEBAR TOGGLE BUTTON USAGE:
   Add the toggle button to your sidebar header:

   <div class="sidebar-header">
       <div class="fs-5 fw-bold text-center pt-3">Main Menu</div>
       <button class="sidebar-toggle" data-action="toggle-sidebar"
               aria-label="Toggle Sidebar">
           <i class="bi bi-chevron-left toggle-icon"></i>
           <i class="bi bi-chevron-right toggle-icon"></i>
       </button>
   </div>

   JavaScript to handle toggle:
   document.querySelector('.sidebar-toggle').addEventListener('click', () => {
       document.querySelector('.portal-container').classList.toggle('collapse-sidebar');
   });

   ======================================================================== */

/* Enhanced visual feedback for collapsed sidebar */
.portal-container.collapse-sidebar .sidebar .nav-link:hover {
    background-color: rgba(var(--bs-primary-rgb), 0.1);
    border-radius: var(--mojo-border-radius);
    transform: translateX(0) scale(1.05);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.portal-container.collapse-sidebar .sidebar-light .nav-link:hover {
    background-color: rgba(var(--bs-primary-rgb), 0.08);
    box-shadow: 0 2px 8px rgba(var(--bs-primary-rgb), 0.2);
}

.portal-container.collapse-sidebar .sidebar-dark .nav-link:hover {
    background-color: rgba(255, 255, 255, 0.1);
    box-shadow: 0 2px 8px rgba(255, 255, 255, 0.1);
}

.portal-container.collapse-sidebar .sidebar-clean .nav-link:hover {
    background-color: var(--bs-light);
    box-shadow: 0 2px 8px rgba(var(--bs-primary-rgb), 0.15);
}

/* Navigation submenu */
.nav-submenu .nav-link {
    padding-left: 2.5rem;
    font-size: 0.9rem;
}

.sidebar-dark .nav-submenu {
    background-color: rgba(0, 0, 0, 0.2);
}

.sidebar-light .nav-submenu {
    background-color: rgba(0, 0, 0, 0.03);
}

.sidebar-clean .nav-submenu {
    background-color: transparent;
}

.sidebar-clean .nav-submenu .nav-link {
    margin-left: 1rem;
    margin-right: 0.5rem;
}

/* Navigation dividers */
.nav-divider {
    margin: 0.75rem 0;
    padding: 0 1rem;
}

.nav-divider-label {
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    padding: 0.25rem 0;
    display: block;
}

.sidebar-dark .nav-divider-label {
    color: var(--bs-secondary-color);
    border-bottom: 1px solid var(--bs-border-color-translucent);
}

.sidebar-light .nav-divider-label {
    color: var(--bs-secondary-color);
    border-bottom: 1px solid var(--bs-border-color);
}

.sidebar-clean .nav-divider-label {
    color: var(--bs-secondary-color);
    border-bottom: 1px solid var(--bs-border-color);
    margin: 0 0.5rem;
}

.nav-divider-item {
    margin: 0.25rem 0;
    padding: 0;
    list-style: none;
}

.nav-divider-line {
    margin: 0 1rem;
    border: 0;
    border-top: 1px solid;
    opacity: 0.25;
}

.sidebar-dark .nav-divider-line {
    border-color: var(--bs-secondary-color);
}

.sidebar-light .nav-divider-line {
    border-color: var(--bs-secondary-color);
}

.sidebar-clean .nav-divider-line {
    border-color: var(--bs-border-color);
    margin: 0 1.5rem;
}

.nav-spacer-item {
    flex: 1;
    list-style: none;
}

/* Navigation sections */
.nav-section {
    margin-bottom: 0.5rem;
}

.nav-section-header {
    padding: 0.5rem 1rem;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.nav-section-header.collapsible {
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: color 0.2s ease;
}

.sidebar-dark .nav-section-header {
    color: var(--bs-secondary-color);
}

.sidebar-dark .nav-section-header.collapsible:hover {
    color: var(--bs-light);
}

.sidebar-light .nav-section-header {
    color: var(--bs-secondary-color);
}

.sidebar-light .nav-section-header.collapsible:hover {
    color: var(--bs-body-color);
}

.sidebar-clean .nav-section-header {
    color: var(--bs-secondary-color);
    margin: 0 0.5rem;
}

.sidebar-clean .nav-section-header.collapsible:hover {
    color: var(--bs-body-color);
}

.nav-section-items {
    padding-left: 0;
}

.sidebar-nav .badge {
    font-size: 0.7rem;
    padding: 0.25rem 0.5rem;
}

/* Sidebar footer */
.sidebar-footer {
    flex-shrink: 0;
    margin-top: auto;
}

.footer-content {
    padding: 1rem;
    font-size: 0.85rem;
}

.sidebar-dark .sidebar-footer {
    border-top: 1px solid var(--bs-border-color-translucent);
}

.sidebar-dark .footer-content {
    color: var(--bs-secondary-color);
}

.sidebar-light .sidebar-footer {
    border-top: 1px solid var(--bs-border-color);
}

.sidebar-light .footer-content {
    color: var(--bs-secondary-color);
}

.sidebar-clean .sidebar-footer {
    border-top: 1px solid var(--bs-border-color);
    background-color: var(--bs-secondary-bg);
}

.sidebar-clean .footer-content {
    color: var(--bs-secondary-color);
}

/* ========================================================================
   MOJO Configuration Switcher (Custom Component)
   ======================================================================== */

.config-switcher {
    position: absolute;
    top: 8px;
    right: 8px;
}

.config-menu {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(var(--bs-dark-rgb), 0.95);
    backdrop-filter: blur(4px);
    z-index: 1050;
    padding: 1rem;
}

.config-menu-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--bs-border-color-translucent);
}

.config-menu-body {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.config-option {
    padding: 0.75rem;
    border: 1px solid var(--bs-border-color-translucent);
    border-radius: var(--bs-border-radius);
    background-color: var(--bs-secondary-bg);
    cursor: pointer;
    transition: all 0.2s ease;
}

.config-option:hover {
    background-color: var(--bs-tertiary-bg);
    border-color: var(--bs-border-color);
}

.config-option.active {
    background-color: var(--bs-primary-bg-subtle);
    border-color: var(--bs-primary);
}

.config-name {
    font-weight: 500;
    color: var(--bs-body-color);
}

/* ========================================================================
   MOJO Group Selector (Custom Component)
   ======================================================================== */

.group-selector-container {
    padding: 0.75rem;
}

.group-selector-wrapper {
    position: relative;
    width: 100%;
}

.group-selector {
    position: relative;
}

.group-selector.disabled {
    opacity: 0.6;
    pointer-events: none;
}

.group-selector .input-group-text {
    background-color: var(--bs-secondary-bg);
    border-color: var(--bs-border-color);
    color: var(--bs-secondary-color);
}

.group-selector .form-control {
    background-color: var(--bs-tertiary-bg);
    border-color: var(--bs-border-color);
    color: var(--bs-body-color);
}

.group-selector .form-control:focus {
    background-color: var(--bs-tertiary-bg);
    border-color: var(--bs-primary);
    color: var(--bs-body-color);
    box-shadow: 0 0 0 0.2rem rgba(var(--bs-primary-rgb), 0.25);
}

.group-selector .form-control::placeholder {
    color: var(--bs-secondary-color);
}

.group-selector .dropdown-toggle {
    background-color: var(--bs-secondary-bg);
    border-color: var(--bs-border-color);
    color: var(--bs-secondary-color);
}

.group-selector .dropdown-toggle:hover,
.group-selector .dropdown-toggle:focus {
    background-color: var(--bs-tertiary-bg);
    border-color: var(--bs-border-color);
    color: var(--bs-body-color);
}

.dropdown-arrow {
    transition: transform 0.2s ease;
}

.group-selector .dropdown-toggle[aria-expanded="true"] .dropdown-arrow {
    transform: rotate(180deg);
}

/* Custom Group Dropdown */
.group-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background-color: var(--bs-body-bg);
    border: 1px solid var(--bs-border-color);
    border-top: none;
    border-radius: 0 0 var(--bs-border-radius) var(--bs-border-radius);
    max-height: 400px;
    overflow-y: auto;
    z-index: 1050;
    box-shadow: var(--bs-box-shadow-lg);
    opacity: 0;
    transform: translateY(-10px);
    transition:
        opacity 0.2s ease,
        transform 0.2s ease;
    display: none;
}

.group-dropdown.show {
    display: block;
    opacity: 1;
    transform: translateY(0);
}

.group-dropdown .dropdown-header {
    padding: 0.75rem 1rem;
    background-color: var(--bs-secondary-bg);
    border-bottom: 1px solid var(--bs-border-color);
    color: var(--bs-secondary-color);
    font-size: 0.875rem;
}

.group-results {
    max-height: 300px;
    overflow-y: auto;
}

.group-item {
    padding: 0;
    border-bottom: 1px solid var(--bs-border-color-translucent);
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.group-item:last-child {
    border-bottom: none;
}

.group-item:hover,
.group-item.focused {
    background-color: var(--bs-secondary-bg);
}

.group-item.selected {
    background-color: var(--bs-primary-bg-subtle);
    border-left: 3px solid var(--bs-primary);
}

.group-item.selected:hover {
    background-color: var(--bs-primary-bg-subtle);
}

.group-content {
    padding: 0.75rem 1rem;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
}

.group-main {
    flex: 1;
    min-width: 0;
}

.group-meta {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 0.25rem;
}

.group-name {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 0.25rem;
    margin-bottom: 0.25rem;
}

.group-hierarchy {
    color: var(--bs-secondary-color);
    font-size: 0.85rem;
    font-weight: normal;
}

.group-name-text {
    color: var(--bs-body-color);
    font-weight: 500;
}

.group-type {
    font-size: 0.7rem;
    padding: 0.25rem 0.5rem;
}

.group-description {
    color: var(--bs-secondary-color);
    font-size: 0.85rem;
    line-height: 1.3;
    margin-top: 0.25rem;
}

.group-item mark {
    background-color: var(--bs-warning-bg-subtle);
    color: var(--bs-body-color);
    padding: 0;
    border-radius: var(--bs-border-radius-sm);
}

.group-member-count {
    display: flex;
    align-items: center;
    color: var(--bs-secondary-color);
    font-size: 0.8rem;
}

.group-status {
    display: flex;
    align-items: center;
}

.status-indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    display: inline-block;
}

.status-indicator.status-active {
    background-color: var(--bs-success);
}

.status-indicator.status-inactive {
    background-color: var(--bs-secondary);
}

.status-indicator.status-archived {
    background-color: var(--bs-danger);
}

.status-indicator.status-pending {
    background-color: var(--bs-warning);
}

.group-dropdown .dropdown-item-text {
    color: var(--bs-secondary-color);
    padding: 1rem;
}

.group-dropdown .dropdown-divider {
    border-top: 1px solid var(--bs-border-color);
    margin: 0.5rem 0;
}

.selected-group-display {
    animation: fadeInUp 0.3s ease;
}

.selected-group-card {
    background-color: var(--bs-primary-bg-subtle);
    border: 1px solid var(--bs-primary-border-subtle);
    border-radius: var(--bs-border-radius);
    padding: 0.75rem;
}

.selected-group-icon {
    flex-shrink: 0;
}

.selected-group-info {
    min-width: 0;
}

.selected-group-name {
    color: var(--bs-body-color);
    margin-bottom: 0.25rem;
}

.selected-group-desc {
    color: var(--bs-secondary-color);
    line-height: 1.3;
}

.selected-group-actions {
    flex-shrink: 0;
}

.group-dropdown::-webkit-scrollbar,
.group-results::-webkit-scrollbar {
    width: 6px;
}

.group-dropdown::-webkit-scrollbar-track,
.group-results::-webkit-scrollbar-track {
    background: var(--bs-secondary-bg);
}

.group-dropdown::-webkit-scrollbar-thumb,
.group-results::-webkit-scrollbar-thumb {
    background: var(--bs-border-color);
    border-radius: var(--bs-border-radius-sm);
}

.group-dropdown::-webkit-scrollbar-thumb:hover,
.group-results::-webkit-scrollbar-thumb:hover {
    background: var(--bs-secondary-color);
}

/* ========================================================================
   Responsive Design
   ======================================================================== */

/* ========================================================================
   Mobile Layout Handling (Class-Based)
   ======================================================================== */

/* Mobile layout: Sidebar fullscreen by default */
.portal-container.mobile-layout #portal-sidebar {
    position: fixed !important;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100vw;
    height: 100vh;
    z-index: var(--mojo-zindex-modal);
    transform: translateX(0); /* Show by default */
    transition: transform 350ms cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
}

.portal-container.mobile-layout #portal-sidebar .sidebar {
    height: 100vh;
    width: 100%;
}

.portal-container.mobile-layout #portal-sidebar .sidebar-container {
    height: 100%;
}

/* Hide sidebar when hide-sidebar class is present */
.portal-container.mobile-layout.hide-sidebar #portal-sidebar {
    transform: translateX(-100%);
    box-shadow: 0 0 20px rgba(0, 0, 0, 0);
}

/* Force full sidebar width on mobile - override collapse states */
.portal-container.mobile-layout #portal-sidebar,
.portal-container.mobile-layout.collapse-sidebar #portal-sidebar {
    inline-size: 100vw !important;
    max-width: 100vw !important;
    flex-basis: 100vw !important;
}

/* Show all text and arrows on mobile - override collapsed state */
.portal-container.mobile-layout .nav-text,
.portal-container.mobile-layout.collapse-sidebar .nav-text {
    opacity: 1 !important;
    width: auto !important;
    overflow: visible !important;
}

.portal-container.mobile-layout .nav-arrow,
.portal-container.mobile-layout.collapse-sidebar .nav-arrow {
    opacity: 1 !important;
}

.portal-container.mobile-layout .sidebar-nav .nav-link,
.portal-container.mobile-layout.collapse-sidebar .sidebar-nav .nav-link {
    justify-content: flex-start !important;
    padding: 1rem !important;
    font-size: 1rem;
}

.portal-container.mobile-layout .nav-submenu,
.portal-container.mobile-layout.collapse-sidebar .nav-submenu {
    display: block !important;
}

/* Mobile: Hide sidebar toggle - use topnav toggle instead */
.portal-container.mobile-layout .sidebar-toggle {
    display: none;
}

/* Mobile: Adjust other sidebar elements */
.portal-container.mobile-layout .group-selector-container {
    padding: 0.5rem;
}

.portal-container.mobile-layout .config-menu {
    padding: 0.5rem;
}

.portal-container.mobile-layout .selected-group-card {
    padding: 1rem;
}

.portal-container.mobile-layout .group-dropdown {
    max-height: 300px;
    left: -5px;
    right: -5px;
    border-radius: 0.5rem;
    border: 1px solid #495057;
    box-shadow: 0 1rem 3rem rgba(0, 0, 0, 0.3);
}

.portal-container.mobile-layout .group-content {
    padding: 1rem 0.75rem;
    flex-direction: column;
    align-items: stretch;
    gap: 0.5rem;
}

.portal-container.mobile-layout .group-meta {
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
}

/* Mobile sidebar backdrop */
.portal-sidebar-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.5);
    z-index: calc(var(--mojo-zindex-modal) - 1);
    opacity: 0;
    visibility: hidden;
    transition:
        opacity 350ms cubic-bezier(0.4, 0, 0.2, 1),
        visibility 350ms cubic-bezier(0.4, 0, 0.2, 1),
        backdrop-filter 350ms cubic-bezier(0.4, 0, 0.2, 1);
    backdrop-filter: blur(0px);
}

/* Show backdrop when mobile sidebar is visible (not hidden) */
.portal-container.mobile-layout:not(.hide-sidebar) .portal-sidebar-backdrop {
    opacity: 1;
    visibility: visible;
    backdrop-filter: blur(4px);
}

/* Enhanced smooth transitions for all sidebar states */
.portal-container #portal-sidebar,
.sidebar-nav .nav-link,
.nav-text,
.nav-arrow,
.sidebar-header,
.sidebar-footer,
.sidebar-header .fs-5 {
    transition-duration: 300ms;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
}

/* Staggered animation for navigation items */
.sidebar-nav .nav-item:nth-child(1) .nav-link {
    transition-delay: 0ms;
}
.sidebar-nav .nav-item:nth-child(2) .nav-link {
    transition-delay: 20ms;
}
.sidebar-nav .nav-item:nth-child(3) .nav-link {
    transition-delay: 40ms;
}
.sidebar-nav .nav-item:nth-child(4) .nav-link {
    transition-delay: 60ms;
}
.sidebar-nav .nav-item:nth-child(5) .nav-link {
    transition-delay: 80ms;
}
.sidebar-nav .nav-item:nth-child(6) .nav-link {
    transition-delay: 100ms;
}
.sidebar-nav .nav-item:nth-child(7) .nav-link {
    transition-delay: 120ms;
}
.sidebar-nav .nav-item:nth-child(8) .nav-link {
    transition-delay: 140ms;
}

/* ========================================================================
   Dark Theme Support
   ======================================================================== */

[data-bs-theme="dark"] .group-dropdown {
    background-color: var(--bs-body-bg);
    border-color: var(--bs-border-color);
}

[data-bs-theme="dark"] .config-menu {
    background-color: rgba(var(--bs-dark-rgb), 0.95);
}

[data-bs-theme="dark"] .config-option {
    background-color: var(--bs-secondary-bg);
    border-color: var(--bs-border-color);
}

[data-bs-theme="dark"] .group-selector .form-control {
    background-color: var(--bs-tertiary-bg);
    border-color: var(--bs-border-color);
    color: var(--bs-body-color);
}

[data-bs-theme="dark"] .group-selector .input-group-text {
    background-color: var(--bs-secondary-bg);
    border-color: var(--bs-border-color);
    color: var(--bs-secondary-color);
}

[data-bs-theme="dark"] .group-item:hover,
[data-bs-theme="dark"] .group-item.focused {
    background-color: var(--bs-secondary-bg);
}

[data-bs-theme="dark"] .selected-group-card {
    background-color: var(--bs-primary-bg-subtle);
    border-color: var(--bs-primary-border-subtle);
}

/* ========================================================================
   Animations
   ======================================================================== */

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ========================================================================
   Accessibility
   ======================================================================== */

.group-item:focus {
    outline: 2px solid #0d6efd;
    outline-offset: -2px;
}

@media (prefers-contrast: high) {
    .group-dropdown {
        border-width: 2px;
        border-color: #fff;
    }

    .group-item.selected {
        border-left-width: 4px;
    }

    .status-indicator {
        border: 1px solid #fff;
    }
}

@media (prefers-reduced-motion: reduce) {
    .group-dropdown {
        transition: none;
    }

    .dropdown-arrow {
        transition: none;
    }

    .selected-group-display {
        animation: none;
    }

    .portal-container #portal-sidebar,
    .sidebar-nav .nav-link,
    .nav-text,
    .nav-arrow,
    .sidebar-header,
    .sidebar-footer,
    .sidebar-header .fs-5 {
        transition: none !important;
        animation: none !important;
    }

    .sidebar-nav .nav-link i {
        transition: none !important;
    }

    .sidebar-nav .nav-link:hover,
    .portal-container.collapse-sidebar .sidebar .nav-link:hover {
        transform: none !important;
        box-shadow: none !important;
    }

    .portal-sidebar-backdrop {
        transition: none !important;
        backdrop-filter: none !important;
    }

    .sidebar-nav .nav-item:nth-child(n) .nav-link {
        transition-delay: 0ms !important;
    }

    .portal-container:not(.collapse-sidebar) #portal-sidebar {
        animation: none !important;
    }

    .sidebar-nav .nav-link.active {
        animation: none !important;
    }

    .nav-link[data-bs-toggle="collapse"] .bi-chevron-down {
        transition: none !important;
    }

    .nav-link[aria-expanded="true"] .bi-chevron-down {
        transform: rotate(180deg) !important;
    }

    /* Accessibility: Respect reduced motion for tooltips */
    .portal-container.collapse-sidebar .sidebar .nav-link:hover::after,
    [data-bs-theme="dark"] .portal-container.collapse-sidebar .sidebar .nav-link:hover::after,
    .portal-container.collapse-sidebar .sidebar .nav-link:hover::before {
        animation: none !important;
        transition: none !important;
        opacity: 1 !important;
        visibility: visible !important;
        transform: translateY(-50%) translateX(0) !important;
    }

    /* Disable toggle button animations */
    .sidebar-toggle,
    .sidebar-toggle .toggle-icon {
        transition: none !important;
        animation: none !important;
    }

    .sidebar-toggle:hover {
        transform: none !important;
    }
}
</text>


/* ========================================================================
   MOJO Portal Utility Classes
   ======================================================================== */

/* Force sidebar states */
.mojo-sidebar-force-open .portal-container {
    --mojo-sidebar-width: 250px !important;
}

.mojo-sidebar-force-open #portal-sidebar {
    inline-size: var(--mojo-sidebar-width) !important;
    max-width: var(--mojo-sidebar-width) !important;
    flex-basis: var(--mojo-sidebar-width) !important;
}

.mojo-sidebar-force-collapsed .portal-container {
    --mojo-sidebar-width: var(--mojo-sidebar-collapsed-width) !important;
}

.mojo-sidebar-force-collapsed #portal-sidebar {
    inline-size: var(--mojo-sidebar-collapsed-width) !important;
    max-width: var(--mojo-sidebar-collapsed-width) !important;
    flex-basis: var(--mojo-sidebar-collapsed-width) !important;
}

.mojo-sidebar-force-hidden #portal-sidebar {
    inline-size: 0 !important;
    max-width: 0 !important;
    flex-basis: 0 !important;
    overflow: hidden !important;
}

/* Sidebar transition control */
.mojo-sidebar-no-transition #portal-sidebar,
.mojo-sidebar-no-transition .sidebar-nav .nav-link,
.mojo-sidebar-no-transition .nav-text,
.mojo-sidebar-no-transition .nav-arrow {
    transition: none !important;
}

/* Additional mobile utilities */
.portal-container.sidebar-opening #portal-sidebar {
    transition-duration: 350ms;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
}

.portal-container.sidebar-closing #portal-sidebar {
    transition-duration: 250ms;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
}

/* Add spring animation for expand */
.portal-container:not(.collapse-sidebar) #portal-sidebar {
    animation: sidebar-expand 400ms cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes sidebar-expand {
    0% {
        transform: scale(0.98) translateX(-2px);
        opacity: 0.9;
    }
    60% {
        transform: scale(1.01) translateX(1px);
    }
    100% {
        transform: scale(1) translateX(0);
        opacity: 1;
    }
}

/* Pulse animation for active nav items */
@keyframes nav-pulse {
    0% {
        box-shadow: 0 0 0 0 rgba(var(--bs-primary-rgb), 0.4);
    }
    70% {
        box-shadow: 0 0 0 6px rgba(var(--bs-primary-rgb), 0);
    }
    100% {
        box-shadow: 0 0 0 0 rgba(var(--bs-primary-rgb), 0);
    }
}

.sidebar-nav .nav-link.active {
    animation: nav-pulse 2s infinite;
}

/* Smooth icon transitions for submenu toggles */
.nav-link[data-bs-toggle="collapse"] .bi-chevron-down {
    transition: transform 250ms cubic-bezier(0.4, 0, 0.2, 1);
}

.nav-link[aria-expanded="true"] .bi-chevron-down {
    transform: rotate(180deg) scale(1.1);
}

/* Sidebar theme utilities */
.mojo-sidebar-theme-auto .sidebar {
    background-color: var(--bs-body-bg);
    color: var(--bs-body-color);
    border-right: 1px solid var(--bs-border-color);
}

.mojo-sidebar-theme-auto .sidebar-nav .nav-link {
    color: var(--bs-body-color);
}

.mojo-sidebar-theme-auto .sidebar-nav .nav-link:hover {
    background-color: var(--bs-secondary-bg);
}

.mojo-sidebar-theme-auto .sidebar-nav .nav-link.active {
    background-color: var(--bs-primary);
    color: var(--bs-white);
}

/* Sidebar state indicators */
.mojo-sidebar-collapsed .nav-text,
.mojo-sidebar-collapsed .nav-arrow {
    opacity: 0;
    width: 0;
    overflow: hidden;
}

.mojo-sidebar-collapsed .sidebar-nav .nav-link {
    justify-content: center;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
}

.mojo-sidebar-collapsed .nav-submenu {
    display: none !important;
}

/* Portal layout variants */
.mojo-portal-fixed .portal-layout {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: var(--mojo-zindex-fixed);
}

.mojo-portal-sticky-sidebar #portal-sidebar {
    position: sticky;
    top: 0;
    height: 100vh;
}

/* Portal content utilities */
.mojo-portal-content-padded .portal-content {
    padding: var(--mojo-spacer-lg);
}

.mojo-portal-content-flush .portal-content,
.mobile-layout .portal-content {
    padding: 0;
}

/* Sidebar animation presets */
.mojo-sidebar-slide #portal-sidebar {
    transition: transform var(--mojo-transition-base) ease-in-out;
}

.mojo-sidebar-fade #portal-sidebar {
    transition: opacity var(--mojo-transition-base) ease-in-out;
}

.mojo-sidebar-scale #portal-sidebar {
    transition: transform var(--mojo-transition-base) cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* JavaScript state classes */
.js-sidebar-transitioning * {
    pointer-events: none;
}

.js-sidebar-ready {
    transition: all var(--mojo-transition-base);
}

/* Accessibility enhancements */
@media (prefers-color-scheme: dark) {
    .mojo-sidebar-theme-auto .sidebar {
        background-color: var(--bs-dark);
        color: var(--bs-light);
        border-right: 1px solid var(--bs-gray-800);
    }

    .mojo-sidebar-theme-auto .sidebar-nav .nav-link {
        color: var(--bs-gray-300);
    }

    .mojo-sidebar-theme-auto .sidebar-nav .nav-link:hover {
        background-color: rgba(255, 255, 255, 0.1);
        color: var(--bs-white);
    }
}

/* Focus management for collapsed sidebar */
.mojo-sidebar-collapsed .nav-link:focus-visible {
    outline: 2px solid var(--bs-primary);
    outline-offset: -2px;
    z-index: 1;
}

/* Skip to content for accessibility */
.mojo-skip-to-content {
    position: absolute;
    top: -40px;
    left: 6px;
    background: var(--bs-primary);
    color: white;
    padding: 8px;
    text-decoration: none;
    z-index: var(--mojo-zindex-tooltip);
    border-radius: var(--mojo-border-radius);
    font-size: 0.875rem;
}

.mojo-skip-to-content:focus {
    top: 6px;
}

/* Mobile body behavior when sidebar is showing */
.portal-container.mobile-layout:not(.hide-sidebar) {
    overflow: hidden;
}

.portal-container.mobile-layout:not(.hide-sidebar) .portal-body {
    pointer-events: none;
}
